<UserControl x:Class="FileSorterXT.Views.SortView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d">
  <Grid>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="430"/>
      <ColumnDefinition Width="14"/>
      <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>

    <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
      <StackPanel>

        <TextBlock FontSize="22" FontWeight="SemiBold" Text="Sort" Margin="0,0,0,14"/>

        <TextBlock FontWeight="SemiBold" Text="Source Folders"/>
<TextBlock Text="Add one or more folders to sort. Preview and Confirm applies to all of them." TextWrapping="Wrap" Margin="0,0,0,8"/>
<ListBox x:Name="SourceList" Height="120" Margin="0,0,0,10"/>
<DockPanel>
  <Button Content="Add Folder" Click="AddSource_Click"/>
  <Button Content="Remove Selected" Click="RemoveSource_Click" Margin="8,4,0,10"/>
  <Button Content="Clear" Click="ClearSources_Click" Margin="8,4,0,10"/>
</DockPanel>

        <Separator/>

        <TextBlock FontWeight="SemiBold" Text="Options"/>
        <CheckBox x:Name="IncludeSubfoldersCheck" Content="Include subfolders" Click="OptionChanged_Click"/>
        <CheckBox x:Name="PreserveStructureCheck" Content="Preserve folder structure (only if subfolders enabled)" Click="OptionChanged_Click"/>
        <CheckBox x:Name="IncludeHiddenCheck" Content="Include hidden and system files" Click="OptionChanged_Click"/>

        <TextBlock FontWeight="SemiBold" Text="Sort Action"/>
        <ComboBox x:Name="ActionModeCombo" SelectionChanged="OptionChanged_SelectionChanged">
          <ComboBoxItem Content="Move (default)"/>
          <ComboBoxItem Content="Copy (safer, uses more disk)"/>
        </ComboBox>

        <TextBlock FontWeight="SemiBold" Text="Confirmation Mode"/>
        <ComboBox x:Name="ConfirmModeCombo" SelectionChanged="OptionChanged_SelectionChanged">
          <ComboBoxItem Content="Manual Confirm"/>
          <ComboBoxItem Content="Auto Confirm (countdown)"/>
          <ComboBoxItem Content="Preview Only (never move)"/>
        </ComboBox>

        <Separator/>

        <Button Content="Preview" Click="Preview_Click"/>
        <DockPanel>
          <Button x:Name="RunButton" Content="Run" Click="Run_Click" IsEnabled="False"/>
          <Button x:Name="CancelAutoButton" Content="Cancel Auto Run" Click="CancelAuto_Click" IsEnabled="False" Margin="8,4,0,10"/>
        </DockPanel>

        <Button Content="Undo Last Run" Click="Undo_Click"/>

        <ProgressBar x:Name="Progress" Height="18" Minimum="0" Maximum="100" Value="0" Margin="0,8,0,10"/>
        <Button x:Name="CancelButton" Content="Cancel Current Run" Click="CancelRun_Click" IsEnabled="False"/>

        <TextBlock x:Name="SummaryText" TextWrapping="Wrap" Margin="0,8,0,0"/>

        <Separator/>

        <TextBlock FontWeight="SemiBold" Text="Unsorted Types Found (no destination mapped)"/>
        <ListView x:Name="UnmappedList" Height="160" Margin="0,0,0,10">
          <ListView.View>
            <GridView>
              <GridViewColumn Header="Extension" Width="120" DisplayMemberBinding="{Binding Ext}"/>
              <GridViewColumn Header="Count" Width="80" DisplayMemberBinding="{Binding Count}"/>
              <GridViewColumn Header="Action" Width="150">
                <GridViewColumn.CellTemplate>
                  <DataTemplate>
                    <Button Content="Map Destination" Click="MapExt_Click" Tag="{Binding Ext}" MinWidth="140"/>
                  </DataTemplate>
                </GridViewColumn.CellTemplate>
              </GridViewColumn>
            </GridView>
          </ListView.View>
        </ListView>

        <TextBlock x:Name="StatusText" TextWrapping="Wrap"/>
      </StackPanel>
    </ScrollViewer>

    <Grid Grid.Column="2">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
      </Grid.RowDefinitions>

      <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,10">
        <TextBlock FontSize="22" FontWeight="SemiBold" Text="Preview Plan"/>
        <TextBlock Text="  "/>
        <TextBlock x:Name="PlanMetaText" VerticalAlignment="Bottom"/>
      </StackPanel>

      <ListView x:Name="PlanList" Grid.Row="1">
        <ListView.View>
          <GridView>
            <GridViewColumn Header="Source" Width="430" DisplayMemberBinding="{Binding SourcePath}"/>
            <GridViewColumn Header="Destination" Width="520" DisplayMemberBinding="{Binding DestinationPath}"/>
            <GridViewColumn Header="Reason" Width="220" DisplayMemberBinding="{Binding Reason}"/>
          </GridView>
        </ListView.View>
      </ListView>

    </Grid>
  </Grid>
</UserControl>
